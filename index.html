<!DOCTYPE html>
<html>
    <head>
        <title>Very Slow Movie Player for Electric Objects</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script>
            // Define utility methods
            function getUrlParameter(sParam) {
                var sPageURL = window.location.search.substring(1),
                    sURLVariables = sPageURL.split('&'),
                    sParameterName,
                    i;
                for (i = 0; i < sURLVariables.length; i++) {
                    sParameterName = sURLVariables[i].split('=');
                    if (sParameterName[0] === sParam) {
                        return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
                    }
                }
            };
            function updateFrame(number) {
                $('#frame').css('background-image', 'url(' + frameURL(number) + ')');
                $('#number').text(number);
            };
            function frameURL(number) {
                return './frames/' + number + '.png'
            }

            // Parse the URL parameters
            var frame_number = parseInt(getUrlParameter('frame'));
            if (!frame_number) {
                frame_number = 1;
            }
            var fps = parseFloat(getUrlParameter('fps'));
            if (!fps) {
                fps = 23.976216;
            }
            var crop = getUrlParameter('crop') === 'true';
            var caption = getUrlParameter('caption') === 'true';

            // Display the frame
            setInterval(function(){
                // First, check to make sure the next frame exists, otherwise stop where we are
                // so that it's easy to pick up where we left off if the server went down
                var bg = new Image();
                bg.onload = function() {
                    frame_number++;
                    updateFrame(frame_number);
                }
                bg.src = frameURL(frame_number + 1)
            }, 60 * 60 / fps * 1000);  // Show N frames per hour, instead of N frames per second
            window.onload = function(){
                if (crop) {
                    $('#frame').addClass('crop');
                }
                if (!caption) {
                    $('#number').hide();
                }
                updateFrame(frame_number);
            };
        </script>
        <style>
            body {
                margin: 0px;
                background-color: #000;
            }
            /* Rotate this div, so that we don't need to rotate the individual frames */
            #container {
                position: fixed;
                transform: rotate(90deg);
                transform-origin: top left;
                width: 1920px;
                height: 1080px;
                left: 1080px;
            }
            #frame {
                position: fixed;
                width: 100%;
                height: 100%;
                top: 50%;
                transform: translateY(-50%);
                background-repeat: no-repeat;
                background-position: center;
            }
            #frame.crop {
                background-size: auto 1080px;
            }
            /* This text should be hardly noticeable, and barely legible, on the EO1 */
            #number {
                background: inherit;
                -webkit-background-clip: text;
                        background-clip: text;
                color: transparent;
                filter: invert(1) grayscale(1) contrast(0);
                text-align: left;
                font-family: sans-serif;
                font-size: 8pt;
            }
        </style>
    </head>
    <body>
        <div id="container">
            <div id="frame">
                <div id="number"></div>
            </div>
        </div>
    </body>
</html>
