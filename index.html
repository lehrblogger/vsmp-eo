<!DOCTYPE html>
<html>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script>
            function getUrlParameter(sParam) {
                var sPageURL = window.location.search.substring(1),
                    sURLVariables = sPageURL.split('&'),
                    sParameterName,
                    i;
                for (i = 0; i < sURLVariables.length; i++) {
                    sParameterName = sURLVariables[i].split('=');
                    if (sParameterName[0] === sParam) {
                        return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
                    }
                }
            };
            function updateFrame(number) {
                $('#frame').attr('src', frameURL(number));
                $('#number').text(number);
            };
            function frameURL(number) {
                return './frames/' + number + '.png'
            }

            var frame_number = parseInt(getUrlParameter('frame_number'));
            if (!frame_number) {
                frame_number = 1;
            }
            var fps = parseFloat(getUrlParameter('fps'));
            if (!fps) {
                fps = 24;
            }
            var crop = getUrlParameter('crop') === 'true';

            setInterval(function(){
                $.ajax({
                    url: frameURL(frame_number + 1),
                    success: function(data) {
                        frame_number++;
                        updateFrame(frame_number);
                    },
                    error: function(xhr, error){
                        updateFrame(frame_number);
                    }
                });
            }, 60 * 60 / fps * 1000);

            window.onload = function(){
                if (crop) {
                    $('#frame').addClass('cropped');
                } else {
                    $('#frame').addClass('letterboxed');
                }
                updateFrame(frame_number);
            };
        </script>
        <style>
            body {
                margin: 0px;
                background-color: #000;
            }
            #frame.letterboxed {
                display: block;
                margin: auto;
            }
            #frame.cropped {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translateX(-50%) translateY(-50%);
                width: 100%;
            }
            #number {
                color: #666;
                background-color: rgba(0,0,0,0.5);
                font-family: sans-serif;
                text-size: 6pt;
                padding: 2px;
                position: fixed;
                bottom: 0;
                left: 0;
            }
        </style>
    </head>
    <body>
        <img id="frame"/>
        <div id="number"></div>
    </body>
</html>
